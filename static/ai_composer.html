<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WhiteNoise · AI 作曲</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/ai_composer.css">
</head>
<body>
    <div class="app ai-app">
        <!-- 头部 -->
        <header class="header">
            <div class="header-nav">
                <a href="/" class="nav-link">← 返回首页</a>
            </div>
            <h1 class="logo">AI 作曲</h1>
            <p class="tagline">描述你的场景，让 AI 为你谱写音效交响乐</p>
        </header>

        <!-- 输入区域 -->
        <section class="input-section">
            <div class="input-card">
                <div class="input-header">
                    <span class="input-icon">✨</span>
                    <h2 class="input-title">描述你想要的场景</h2>
                </div>
                <textarea 
                    id="sceneInput" 
                    class="scene-textarea" 
                    placeholder="例如：在树林中行走，旅途中有小鸟的叫声，有风声，还能听到远处海浪的声音..."
                    rows="4"
                ></textarea>
                <div class="input-footer">
                    <div class="char-count">
                        <span id="charCount">0</span> / 1000
                    </div>
                    <button class="btn-generate" id="btnGenerate">
                        <svg class="icon-sparkle" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
                        </svg>
                        生成音效
                    </button>
                </div>
            </div>
            
            <!-- 示例提示 -->
            <div class="examples-section">
                <span class="examples-label">试试这些场景：</span>
                <div class="examples-tags">
                    <button class="example-tag" data-scene="深夜的咖啡馆，窗外下着小雨，室内有轻柔的人声和时钟的滴答声">深夜咖啡馆</button>
                    <button class="example-tag" data-scene="森林中的清晨，鸟儿在歌唱，远处有潺潺的溪流声，偶尔有风吹过树叶的沙沙声">森林清晨</button>
                    <button class="example-tag" data-scene="海边的篝火晚会，海浪声此起彼伏，篝火噼啪作响，还有远处的雷声">海边篝火</button>
                    <button class="example-tag" data-scene="图书馆的安静午后，有轻微的翻书声，远处偶尔有脚步声，窗外有小雨">图书馆午后</button>
                </div>
            </div>
        </section>

        <!-- 加载状态 -->
        <section class="loading-section" id="loadingSection" style="display: none;">
            <div class="loading-card">
                <div class="loading-animation">
                    <div class="wave-bars">
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                        <span></span>
                    </div>
                </div>
                <p class="loading-text">AI 正在创作中...</p>
                <p class="loading-hint">这可能需要 10-30 秒</p>
            </div>
        </section>

        <!-- 结果区域 -->
        <section class="result-section" id="resultSection" style="display: none;">
            <div class="result-card">
                <div class="result-header">
                    <div class="result-info">
                        <h3 class="result-title" id="resultTitle">-</h3>
                        <p class="result-desc" id="resultDesc">-</p>
                    </div>
                    <div class="result-meta">
                        <span class="result-duration" id="resultDuration">0分钟</span>
                        <span class="result-tracks" id="resultTracks">0个音轨</span>
                    </div>
                </div>

                <!-- 时间轴预览 -->
                <div class="timeline-preview" id="timelinePreview">
                    <!-- 动态生成 -->
                </div>

                <!-- 音轨列表 -->
                <div class="tracks-preview" id="tracksPreview">
                    <!-- 动态生成 -->
                </div>

                <!-- 控制按钮 -->
                <div class="result-controls">
                    <button class="btn-play-preview" id="btnPlayPreview">
                        <svg class="icon-play" width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M8 5v14l11-7z"/>
                        </svg>
                        <svg class="icon-pause" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" style="display:none">
                            <path d="M6 4h4v16H6zM14 4h4v16h-4z"/>
                        </svg>
                        <span class="btn-text">试听</span>
                    </button>
                    <button class="btn-export" id="btnExport">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        导出 MP3
                    </button>
                    <button class="btn-regenerate" id="btnRegenerate">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 4v6h6M23 20v-6h-6"/>
                            <path d="M20.49 9A9 9 0 0 0 5.64 5.64L1 10m22 4l-4.64 4.36A9 9 0 0 1 3.51 15"/>
                        </svg>
                        重新生成
                    </button>
                    <button class="btn-save" id="btnSave">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z"/>
                            <polyline points="17 21 17 13 7 13 7 21"/>
                            <polyline points="7 3 7 8 15 8"/>
                        </svg>
                        保存到我的组合
                    </button>
                </div>
            </div>
        </section>

        <!-- 错误提示 -->
        <section class="error-section" id="errorSection" style="display: none;">
            <div class="error-card">
                <div class="error-icon">⚠️</div>
                <h3 class="error-title">生成失败</h3>
                <p class="error-message" id="errorMessage">-</p>
                <button class="btn-retry" id="btnRetry">重试</button>
            </div>
        </section>

        <!-- 导出弹窗 -->
        <div class="export-modal" id="exportModal" style="display: none;">
            <div class="export-modal-content">
                <button class="btn-close-modal" id="btnCloseModal">×</button>
                <div class="export-status" id="exportStatus">
                    <div class="export-spinner"></div>
                    <p>正在渲染音频...</p>
                    <p class="export-hint">这可能需要几分钟时间</p>
                </div>
                <div class="export-complete" id="exportComplete" style="display: none;">
                    <div class="export-success-icon">✓</div>
                    <p>导出成功！</p>
                    <a class="btn-download" id="downloadLink" href="#" download>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/>
                            <polyline points="7 10 12 15 17 10"/>
                            <line x1="12" y1="15" x2="12" y2="3"/>
                        </svg>
                        下载 MP3
                    </a>
                </div>
            </div>
        </div>

        <!-- 历史记录 -->
        <section class="history-section" id="historySection">
            <div class="section-header">
                <h2 class="section-title">🎼 AI 创作记录</h2>
            </div>
            <div class="history-grid" id="historyGrid">
                <!-- 动态生成 -->
            </div>
        </section>
    </div>

    <script src="/static/js/ai_composer.js"></script>
</body>
</html>
